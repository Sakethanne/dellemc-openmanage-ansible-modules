- '        This module allows you to update the firmware of a specific'
- '        host in the cluster.'
- ''
- 'ADDED IN: version 9.10.0 of dellemc.openmanage'
- ''
- 'OPTIONS (= is mandatory):'
- ''
- '- ca_path'
- '        The Privacy Enhanced Mail (PEM) file that contains a CA'
- '        certificate to be used for the validation.'
- '        default: null'
- '        type: path'
- ''
- '- check_vSAN_health'
- '        Check vSAN health while updating the firmware.'
- '        `true'' checks the vSAN health while updating the firmware.'
- '        `false'' does not check the vSAN health while updating the'
- '        firmware.'
- '        default: null'
- '        type: bool'
- ''
- '- date_time'
- '        Date and time when the job must run. This is applicable when'
- '        `run_now'' is `false''.'
- '        The supported format is YYYY-MM-DDThh:mm:ss<offset>.'
- '        default: null'
- '        type: str'
- ''
- '- delete_job_queue'
- '        Whether to delete the job queue in iDRAC while updating'
- '        firmware.'
- '        `true'' deletes the job queue in iDRAC while updating firmware.'
- '        `false'' does not delete the job queue in iDRAC while updating'
- '        firmware.'
- '        default: null'
- '        type: bool'
- ''
- '- drs_check'
- '        Allows you to check if DRS of the cluster is enabled or not.'
- '        `true'' checks if Distributed Resource Scheduler (DRS) of the'
- '        cluster is enabled.'
- '        `false'' does not check if DRS of the cluster is enabled.'
- '        default: false'
- '        type: bool'
- ''
- '- enter_maintenance_mode_options'
- '        VM migration policy during management mode.'
- '        `FULL_DATA_MIGRATION'' for full data migration.'
- '        `ENSURE_ACCESSIBILITY'' for ensuring accessibility.'
- '        `NO_DATA_MIGRATION'' does not migrate any data.'
- '        choices: [FULL_DATA_MIGRATION, ENSURE_ACCESSIBILITY, NO_DATA_MIGRATION]'
- '        default: null'
- '        type: str'
- ''
- '- enter_maintenance_mode_timeout'
- '        Time out value during maintenance mode in minutes.'
- '        default: 60'
- '        type: int'
- ''
- '- evacuate_VMs'
- '        Allows to move the virtual machine (VM) to other host when'
- '        current host is powered off.'
- '        `true'' moves the VM to another host when the current host is'
- '        powered off.'
- '        `false'' does not move the VM to another host when the current'
- '        host is powered off.'
- '        default: false'
- '        type: bool'
- ''
- '- exit_maintenance_mode'
- '        Whether to exit management mode after Update.'
- '        `true'' exits the management mode after Update.'
- '        `false'' does not exit the management mode after Update.'
- '        default: false'
- '        type: bool'
- ''
- = hostname
- '        IP address or hostname of the OpenManage Enterprise Modular.'
- '        type: str'
- ''
- '- job_description'
- '        Update job description.'
- '        default: null'
- '        type: str'
- ''
- '- job_name'
- '        Update job name.'
- '        default: null'
- '        type: str'
- ''
- '- job_wait'
- '        Whether to wait till completion of the job. This is applicable'
- '        when `power_on'' is `true''.'
- '        `true'' waits for job completion.'
- '        `false'' does not wait for job completion.'
- '        default: true'
- '        type: bool'
- ''
- '- job_wait_timeout'
- '        The maximum wait time of `job_wait'' in seconds. The job is'
- '        tracked only for this duration.'
- '        This option is applicable when `job_wait'' is `true''.'
- '        default: 1200'
- '        type: int'
- ''
- '- maintenance_mode_count_check'
- '        Allows to check if any host in cluster is in management mode.'
- '        `true'' checks if any host in cluster is in management mode.'
- '        `false'' does not check if any host in cluster is in management'
- '        mode.'
- '        default: null'
- '        type: bool'
- ''
- '- port'
- '        OpenManage Enterprise HTTPS port.'
- '        default: 443'
- '        type: int'
- ''
- '- reboot_options'
- '        Host reboot option for firmware update.'
- '        `FORCEREBOOT'' will force reboot the server.'
- '        `SAFEREBOOT'' reboots the server in safe mode.'
- '        `NEXTREBOOT'' does not reboot the server.'
- '        choices: [FORCEREBOOT, SAFEREBOOT, NEXTREBOOT]'
- '        default: SAFEREBOOT'
- '        type: str'
- ''
- '- reset_idrac'
- '        Whether to reset the iDRAC while performing firmware update.'
- '        `true'' resets the iDRAC while performing firmware update.'
- '        `false'' does not reset the iDRAC while performing firmware'
- '        update.'
- '        default: null'
- '        type: bool'
- ''
- = run_now
- '        Whether to run the update job now or later.'
- '        `true'' runs the update job instantly.'
- '        `false'' runs the update at the specified `date_time''.'
- '        type: bool'
- ''
- = targets
- '        The target details for the firmware update operation.'
- '        Either `cluster'', `servicetag'' or `host'' is required for the'
- '        firmware update operation.'
- '        elements: dict'
- '        type: list'
- ''
- '        SUBOPTIONS:'
- ''
- '        - cluster'
- '            Name of the cluster to which firmware needs to updated.'
- '            `cluster'' is mutually exclusive with `servicetag'' and'
- '            `host''.'
- '            This module supports only single cluster update.'
- '            default: null'
- '            type: str'
- ''
- '        = firmware_components'
- '            List of host firmware components to update.'
- '            [dellemc.openmanage.omevv_firmware_compliance_info] module'
- '            can be used to fetch the supported firmware components.'
- '            elements: str'
- '            type: list'
- ''
- '        - host'
- '            The IP address or hostname of the host.'
- '            `host'' is mutually exclusive with `servicetag'' and'
- '            `cluster''.'
- '            [dellemc.openmanage.omevv_device_info] module can be used'
- '            to fetch the device information.'
- '            default: null'
- '            type: str'
- ''
- '        - servicetag'
- '            The service tag of the host.'
- '            `servicetag'' is mutually exclusive with `host'' and'
- '            `cluster''.'
- '            [dellemc.openmanage.omevv_device_info] module can be used'
- '            to fetch the device information.'
- '            default: null'
- '            type: str'
- ''
- '- timeout'
- '        The socket level timeout in seconds.'
- '        default: 30'
- '        type: int'
- ''
- '- validate_certs'
- '        Whether to check SSL certificate. - If `true'', the SSL'
- '        certificates will be validated. - If `false'', the SSL'
- '        certificates will not be validated.'
- '        default: true'
- '        type: bool'
- ''
- '- vcenter_password'
- '        Password for OpenManage Enterprise Integration for VMware'
- '        vCenter (OMEVV).'
- '        If the password is not provided, then the environment variable'
- '        `OMEVV_VCENTER_PASSWORD'' is used.'
- '        Example: export OMEVV_VCENTER_PASSWORD=password'
- '        default: null'
- '        type: str'
- ''
- '- vcenter_username'
- '        Username for OpenManage Enterprise Integration for VMware'
- '        vCenter (OMEVV).'
- '        If the username is not provided, then the environment variable'
- '        `OMEVV_VCENTER_USERNAME'' is used.'
- '        Example: export OMEVV_VCENTER_USERNAME=username'
- '        default: null'
- '        type: str'
- ''
- '- vcenter_uuid'
- '        Universally Unique Identifier (UUID) of vCenter.'
- '        vCenter UUID details can be retrieved using'
- '        [dellemc.openmanage.omevv_vcenter_info] module.'
- '        If UUID is not provided, then the environment variable'
- '        `OMEVV_VCENTER_UUID'' is used.'
- '        Example: export OMEVV_VCENTER_UUID=uuid'
- '        default: null'
- '        type: str'
- ''
- ''
- 'ATTRIBUTES:'
- ''
- '        check_mode:'
- '          description: Can run in check_mode and return changed status prediction
    without'
- '            modifying target, if not supported the action will be skipped.'
- '          support: full'
- '        diff_mode:'
- '          description: Will return details on what has changed (or possibly needs
    changing'
- '            in check_mode), when in diff mode.'
- '          support: full'
- ''
- 'NOTES:'
- '      * Run this module from a system that has direct access to'
- '        Dell OpenManage Enterprise.'
- '      * This module supports IPv4 and IPv6 addresses.'
- ''
- ''
- 'REQUIREMENTS:  python >= 3.9.6'
- ''
- 'AUTHOR: Rajshekar P(@rajshekarp87)'
- ''
- 'EXAMPLES:'
- ''
- '---'
- '- name: Immediately update the firmware of a single component for a specific host'
- '  dellemc.openmanage.omevv.omevv_firmware:'
- '    hostname: "192.168.0.1"'
- '    vcenter_uuid: "xxxxx"'
- '    vcenter_username: "username"'
- '    vcenter_password: "password"'
- '    ca_path: "path/to/ca_file"'
- '    run_now: false'
- '    date_time: "2024-09-10T20:50:00Z"'
- '    enter_maintenance_mode_timeout: 60'
- '    enter_maintenance_mode_options: FULL_DATA_MIGRATION'
- '    drs_check: true'
- '    evacuate_VMs: true'
- '    exit_maintenance_mode: true'
- '    reboot_options: NEXTREBOOT'
- '    maintenance_mode_count_check: true'
- '    check_vSAN_health: true'
- '    reset_idrac: true'
- '    delete_job_queue: true'
- '    targets:'
- '      - servicetag: SVCTAG1'
- '        firmware_components:'
- '          - "DCIM:INSTALLED#802__Diagnostics.Embedded.1:LC.Embedded.1"'
- ''
- '- name: Update the firmware of multiple components at scheduled time for a specific
    host'
- '  dellemc.openmanage.omevv.omevv_firmware:'
- '    hostname: "192.168.0.1"'
- '    vcenter_uuid: "xxxxx"'
- '    vcenter_username: "username"'
- '    vcenter_password: "password"'
- '    ca_path: "path/to/ca_file"'
- '    run_now: false'
- '    date_time: "2024-09-10T20:50:00+05:30"'
- '    enter_maintenance_mode_timeout: 60'
- '    enter_maintenance_mode_options: ENSURE_ACCESSIBILITY'
- '    drs_check: true'
- '    evacuate_VMs: true'
- '    exit_maintenance_mode: true'
- '    reboot_options: FORCEREBOOT'
- '    maintenance_mode_count_check: true'
- '    check_vSAN_health: true'
- '    reset_idrac: false'
- '    delete_job_queue: false'
- '    targets:'
- '      - host: 192.168.0.2'
- '        firmware_components:'
- '          - "DCIM:INSTALLED#iDRAC.Embedded.1-1#IDRACinfo"'
- '          - "DCIM:INSTALLED#301_C_BOSS.SL.14-1"'
- '          - "DCIM:INSTALLED#807__TPM.Integrated.1-1"'
- ''
- '- name: Update the firmware of multiple components at scheduled time for a cluster'
- '  dellemc.openmanage.omevv.omevv_firmware:'
- '    hostname: "192.168.0.1"'
- '    vcenter_uuid: "xxxxx"'
- '    vcenter_username: "username"'
- '    vcenter_password: "password"'
- '    ca_path: "path/to/ca_file"'
- '    run_now: false'
- '    date_time: "2024-09-10T20:50:00+05:30"'
- '    enter_maintenance_mode_timeout: 60'
- '    enter_maintenance_mode_options: ENSURE_ACCESSIBILITY'
- '    drs_check: true'
- '    evacuate_VMs: true'
- '    exit_maintenance_mode: true'
- '    reboot_options: SAFEREBOOT'
- '    maintenance_mode_count_check: true'
- '    check_vSAN_health: true'
- '    reset_idrac: false'
- '    delete_job_queue: false'
- '    targets:'
- '      - cluster: cluster_a'
- '        firmware_components:'
- '          - "DCIM:INSTALLED#iDRAC.Embedded.1-1#IDRACinfo"'
- '          - "DCIM:INSTALLED#301_C_BOSS.SL.14-1"'
- '          - "DCIM:INSTALLED#807__TPM.Integrated.1-1"'
- ''
- '- name: Retrieve firmware compliance report of all the hosts in the specific cluster'
- '  dellemc.openmanage.omevv_firmware_compliance_info:'
- '    hostname: "192.168.0.1"'
- '    vcenter_uuid: "xxxxx"'
- '    vcenter_username: "username"'
- '    vcenter_password: "password"'
- '    ca_path: "path/to/ca_file"'
- '    clusters:'
- '      - cluster_name: cluster_a'
- '  register: compliance_data'
- ''
- '- name: Extract source name of all components'
- '  set_fact:'
- '    source_names: "{{ compliance_data.hostComplianceReports[0].componentCompliances|json_query(''*.sourceName'')
    }}"'
- ''
- '- name: Extract source name of a specific component'
- '  set_fact:'
- '    source_name: "{{ compliance_data.hostComplianceReports[0].componentCompliances[0].sourceName
    }}"'
- ''
- '- name: Update firmware at the scheduled time for a specific host'
- '  dellemc.openmanage.omevv.omevv_firmware:'
- '    hostname: "192.168.0.1"'
- '    vcenter_uuid: "xxxxx"'
- '    vcenter_username: "username"'
- '    vcenter_password: "password"'
- '    ca_path: "path/to/ca_file"'
- '    run_now: false'
- '    date_time: "2024-09-10T20:50:00Z"'
- '    enter_maintenance_mode_timeout: 60'
- '    enter_maintenance_mode_options: NO_DATA_MIGRATION'
- '    drs_check: true'
- '    evacuate_VMs: false'
- '    exit_maintenance_mode: true'
- '    reboot_options: SAFEREBOOT'
- '    maintenance_mode_count_check: true'
- '    check_vSAN_health: true'
- '    reset_idrac: true'
- '    delete_job_queue: true'
- '    targets:'
- '      - servicetag: SVCTAG1'
- '        firmware_components:'
- '          - "{{ source_name }}"'
- ''
- ''
- 'RETURN VALUES:'
- '- error_info'
- '        Details of the module HTTP Error.'
- '        returned: on HTTP error'
- '        sample:'
- '          errorCode: ''20058'''
- '          message: Update Job already running for group id 1004 corresponding to
    cluster OMAM-Cluster-1.'
- '            Wait for its completion and trigger.'
- '        type: dict'
- ''
- '- msg'
- '        Status of the firmware update operation.'
- '        returned: always'
- '        sample: Successfully created the OMEVV baseline profile.'
- '        type: str'
